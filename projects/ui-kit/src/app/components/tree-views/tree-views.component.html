<div class="tree-views-demo">
  <header class="demo-header">
    <h1>TreeView Components</h1>
    <p>
      A hierarchical tree component that replicates PrimeNG's p-tree
      functionality with support for single, multiple, and checkbox selection
      modes, filtering, and rich event handling.
    </p>
  </header>

  <div class="cards-container">
    <!-- Features -->
    <app-demo-card title="Features">
      <div class="features-grid">
        @for (feature of features; track feature.title) {
        <div class="feature-item">
          <h4>{{ feature.title }}</h4>
          <p>{{ feature.description }}</p>
        </div>
        }
      </div>
    </app-demo-card>

    <!-- Basic Usage -->
    <app-demo-card title="Basic Tree" [sourceCode]="codeExamples.basic">
      <p>Basic tree structure with expand/collapse functionality.</p>

      <div class="demo-actions">
        <button type="button" class="demo-btn" (click)="expandAll()">
          Expand All
        </button>
        <button type="button" class="demo-btn" (click)="collapseAll()">
          Collapse All
        </button>
      </div>

      <i-tree-view [value]="basicTreeData" scrollHeight="300px"> </i-tree-view>
    </app-demo-card>

    <!-- Single Selection -->
    <app-demo-card
      title="Single Selection"
      [sourceCode]="codeExamples.selection"
    >
      <p>
        Click on any node to select it. Only one node can be selected at a time.
      </p>

      <div class="demo-actions">
        <button type="button" class="demo-btn" (click)="clearSingleSelection()">
          Clear Selection
        </button>
      </div>

      <i-tree-view
        [value]="organizationData"
        selectionMode="single"
        [(selection)]="singleSelection"
        (onNodeSelect)="onSingleNodeSelect($event)"
        (onNodeUnselect)="onSingleNodeUnselect($event)"
        scrollHeight="300px"
      >
      </i-tree-view>

      @if (singleSelection) {
      <div class="selection-info">
        <strong>Selected:</strong> {{ singleSelection.label }}
        <details>
          <summary>View Details</summary>
          <pre>{{ getNodeSummary(singleSelection) | json }}</pre>
        </details>
      </div>
      }
    </app-demo-card>

    <!-- Multiple Selection -->
    <app-demo-card title="Multiple Selection">
      <p>Hold Ctrl/Cmd and click to select multiple nodes.</p>

      <div class="demo-actions">
        <button
          type="button"
          class="demo-btn"
          (click)="clearMultipleSelection()"
        >
          Clear Selection
        </button>
      </div>

      <i-tree-view
        [value]="organizationData"
        selectionMode="multiple"
        [(selection)]="multipleSelection"
        (onNodeSelect)="onMultipleNodeSelect($event)"
        (onNodeUnselect)="onMultipleNodeUnselect($event)"
        scrollHeight="300px"
      >
      </i-tree-view>

      @if (multipleSelection.length > 0) {
      <div class="selection-info">
        <strong>Selected ({{ multipleSelection.length }} items):</strong>
        <ul>
          @for (node of multipleSelection; track node.key) {
          <li>
            {{ node.label }} <small>({{ node.key }})</small>
          </li>
          }
        </ul>
        <details>
          <summary>View Details</summary>
          <pre>{{ getMultipleNodesSummary(multipleSelection) | json }}</pre>
        </details>
      </div>
      }
    </app-demo-card>

    <!-- Checkbox Selection -->
    <app-demo-card title="Checkbox Selection">
      <p>
        Select nodes using checkboxes. Child selections propagate to parents.
      </p>

      <div class="demo-actions">
        <i-checkbox
          [(ngModel)]="selectAllChecked"
          label="Select All"
          id="select-all-checkbox"
          (onChange)="onSelectAllChange()"
        >
        </i-checkbox>
        <button
          type="button"
          class="demo-btn"
          (click)="clearCheckboxSelection()"
        >
          Clear Selection
        </button>
      </div>

      <i-tree-view
        [value]="organizationData"
        selectionMode="checkbox"
        [(selection)]="checkboxSelection"
        (onNodeSelect)="onCheckboxNodeSelect($event)"
        (onNodeUnselect)="onCheckboxNodeUnselect($event)"
        scrollHeight="300px"
      >
      </i-tree-view>

      @if (checkboxSelection.length > 0) {
      <div class="selection-info">
        <strong>Selected ({{ checkboxSelection.length }} items):</strong>
        <ul>
          @for (node of checkboxSelection; track node.key) {
          <li>
            {{ node.label }} <small>({{ node.key }})</small>
          </li>
          }
        </ul>
        <details>
          <summary>View Details</summary>
          <pre>{{ getMultipleNodesSummary(checkboxSelection) | json }}</pre>
        </details>
      </div>
      }
    </app-demo-card>

    <!-- Filtering -->
    <app-demo-card title="Filtering" [sourceCode]="codeExamples.filtering">
      <p>Search through tree nodes using the built-in filter.</p>

      <i-tree-view
        [value]="basicTreeData"
        [filter]="true"
        filterPlaceholder="Search files and folders..."
        scrollHeight="300px"
      >
      </i-tree-view>
    </app-demo-card>

    <!-- Events -->
    <app-demo-card title="Events" [sourceCode]="codeExamples.events">
      <p>
        TreeView emits various events for node interactions. Check the console
        for event logs.
      </p>

      <i-tree-view
        [value]="basicTreeData"
        selectionMode="single"
        (onNodeSelect)="onSingleNodeSelect($event)"
        (onNodeUnselect)="onSingleNodeUnselect($event)"
        (onNodeExpand)="onNodeExpand($event)"
        (onNodeCollapse)="onNodeCollapse($event)"
        scrollHeight="250px"
      >
      </i-tree-view>
    </app-demo-card>

    <!-- Scrollable -->
    <app-demo-card
      title="Scrollable TreeView"
      [sourceCode]="codeExamples.scrollable"
    >
      <p>Set a fixed height for the tree to make it scrollable.</p>

      <i-tree-view [value]="organizationData" scrollHeight="200px">
      </i-tree-view>
    </app-demo-card>

    <!-- API Documentation -->
    <app-demo-card title="TreeView API">
      <div class="api-section">
        <h4>Inputs</h4>
        <table class="api-table">
          <thead>
            <tr>
              <th>Property</th>
              <th>Type</th>
              <th>Default</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>value</td>
              <td>ITreeNode[]</td>
              <td>[]</td>
              <td>An array of tree nodes</td>
            </tr>
            <tr>
              <td>selectionMode</td>
              <td>'single' | 'multiple' | 'checkbox'</td>
              <td>'single'</td>
              <td>Selection mode of the tree</td>
            </tr>
            <tr>
              <td>selection</td>
              <td>ITreeNode | ITreeNode[]</td>
              <td>null</td>
              <td>Selected node(s)</td>
            </tr>
            <tr>
              <td>scrollHeight</td>
              <td>string</td>
              <td>undefined</td>
              <td>Maximum height of the tree container</td>
            </tr>
            <tr>
              <td>filter</td>
              <td>boolean</td>
              <td>false</td>
              <td>Whether to show filter input</td>
            </tr>
            <tr>
              <td>filterPlaceholder</td>
              <td>string</td>
              <td>'Search'</td>
              <td>Placeholder text for filter input</td>
            </tr>
            <tr>
              <td>emptyMessage</td>
              <td>string</td>
              <td>'No data found'</td>
              <td>Message to display when no data</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="api-section">
        <h4>Outputs</h4>
        <table class="api-table">
          <thead>
            <tr>
              <th>Event</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>onNodeSelect</td>
              <td>{{ "{" }} originalEvent: Event, node: ITreeNode {{ "}" }}</td>
              <td>Fired when a node is selected</td>
            </tr>
            <tr>
              <td>onNodeUnselect</td>
              <td>{{ "{" }} originalEvent: Event, node: ITreeNode {{ "}" }}</td>
              <td>Fired when a node is unselected</td>
            </tr>
            <tr>
              <td>onNodeExpand</td>
              <td>{{ "{" }} originalEvent: Event, node: ITreeNode {{ "}" }}</td>
              <td>Fired when a node is expanded</td>
            </tr>
            <tr>
              <td>onNodeCollapse</td>
              <td>{{ "{" }} originalEvent: Event, node: ITreeNode {{ "}" }}</td>
              <td>Fired when a node is collapsed</td>
            </tr>
            <tr>
              <td>selectionChange</td>
              <td>ITreeNode | ITreeNode[]</td>
              <td>Fired when selection changes</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="api-section">
        <h4>ITreeNode Interface</h4>
        <pre class="code-block">{{ codeExamples.customization }}</pre>
      </div>
    </app-demo-card>
  </div>
</div>
